{
	"name": "DQF_pipeline",
	"properties": {
		"activities": [
			{
				"name": "ForEach Dealer",
				"type": "ForEach",
				"dependsOn": [],
				"userProperties": [],
				"typeProperties": {
					"items": {
						"value": "@pipeline().parameters.Dealer_table",
						"type": "Expression"
					},
					"activities": [
						{
							"name": "Dealer Notebook",
							"type": "DatabricksNotebook",
							"dependsOn": [],
							"policy": {
								"timeout": "7.00:00:00",
								"retry": 0,
								"retryIntervalInSeconds": 30,
								"secureOutput": false,
								"secureInput": false
							},
							"userProperties": [],
							"typeProperties": {
								"notebookPath": "/DataEngineering/DATAQUALITY/02_IMPLEMENTATION/RUN_DQF_DEALER",
								"baseParameters": {
									"Date": {
										"value": "@formatDateTime(adddays(utcnow(),-1),'yyyy-MM-dd')",
										"type": "Expression"
									},
									"schema_name": {
										"value": "DEALER",
										"type": "Expression"
									},
									"table_name": {
										"value": "@item()",
										"type": "Expression"
									}
								}
							},
							"linkedServiceName": {
								"referenceName": "MBUSA_DEV",
								"type": "LinkedServiceReference"
							}
						}
					]
				}
			},
			{
				"name": "ForEach Waranty",
				"type": "ForEach",
				"dependsOn": [],
				"userProperties": [],
				"typeProperties": {
					"items": {
						"value": "@pipeline().parameters.Warranty_tables",
						"type": "Expression"
					},
					"activities": [
						{
							"name": "Waranty Notebook",
							"type": "DatabricksNotebook",
							"dependsOn": [],
							"policy": {
								"timeout": "7.00:00:00",
								"retry": 0,
								"retryIntervalInSeconds": 30,
								"secureOutput": false,
								"secureInput": false
							},
							"userProperties": [],
							"typeProperties": {
								"notebookPath": "/DataEngineering/DATAQUALITY/02_IMPLEMENTATION/DQF_RUN",
								"baseParameters": {
									"Date": "@formatDateTime(adddays(utcnow(),-1),'yyyy-MM-dd')",
									"table_name": {
										"value": "@item()",
										"type": "Expression"
									},
									"Path": "/mnt/adls-wrnty-edw/processed",
									"environment": "MVP",
									"schema_name": "WARANTY"
								}
							},
							"linkedServiceName": {
								"referenceName": "MBUSA_DEV",
								"type": "LinkedServiceReference"
							}
						}
					]
				}
			}
		],
		"parameters": {
			"Warranty_tables": {
				"type": "array",
				"defaultValue": [
					"CAC_AGNT_DIM",
					"CCAS_DIM",
					"CCAS_FCT",
					"CCAS_NOT_FCT",
					"CLM_DMG_DLR_TXT",
					"CLM_FIL_DES_AUD",
					"CLM_PART_DIAGN",
					"CNSTR_GRP_MSTR",
					"COST_CARRIER",
					"COST_DISTR_SMRY",
					"CPOI_HDR",
					"CPOI_STAT_CDE",
					"CSPS_SC_DLR_SMY",
					"CST_DSTN_SMRY_RP",
					"DAMAGE_CODE",
					"DAMAGE_PART",
					"DEBIT_CDE_DES",
					"DLR_GDWLL_BDGT",
					"DLR_PREV_DLR_REL",
					"DSOPCD_SMRY",
					"ELC_CANCLN",
					"ELC_CONTR_HIST",
					"ELC_COST_CARR",
					"ELC_PEN_DLR_SMY",
					"ELC_PKG",
					"ELC_PKG_CDE",
					"ELC_REV_EXP_MTH",
					"ELC_REV_EXP_PROJ_QTR",
					"ELC_STAT_CDE",
					"FFV_CUST_LYL_SMY",
					"FFV_DLR_COM_SMY",
					"FFV_DLR_DMG_SMY",
					"FFV_DLR_PF_SMY",
					"FFV_DLR_SMY",
					"FFV_NATL_SMY",
					"FFV_RGN_SMY",
					"FFV_VEH_RPR",
					"FFV_VEH_RRPR",
					"GALA_DMG_RUL",
					"KDM_CAMPAIGN",
					"KDM_CMPGN_VEH",
					"KDM_PEND_CMPGN_VIN_ASSN",
					"KPI",
					"KPI_BAUM",
					"KPI_BAUM_DLR",
					"KPI_CLSF",
					"KPI_CLSF_DLR",
					"KPI_CLSF_ROL",
					"KPI_DLR",
					"KPI_DLR_PIP",
					"KPI_DMG_CGRP_DLR",
					"KPI_DMG_CGRP_NATL",
					"KPI_DMG_CGRP_ROL",
					"MBRC_ACCT_ACTV",
					"MBRC_ACCT_ORD_SRC_CDE",
					"MBRC_ACCT_STAT_CDE",
					"MBRC_PKG",
					"MBRC_VEH_EXCL",
					"PEND_CMPGN_DTL",
					"PTSS_CASE",
					"PTSS_CASE_COM",
					"PTSS_CASE_STAT",
					"PTSS_CASE_STAT_DEPT_BOX",
					"PTSS_CASE_VEH_CU_FAUL",
					"PTSS_COM_TYP_CDE",
					"PTSS_DLR_CNCT",
					"PTSS_DLR_CNTC_PREF_CDE",
					"PTSS_FL_LVL_CDE",
					"PTSS_HDOF_RTNG_CDE",
					"PTSS_STAT_CDE",
					"PTSS_VEH_CU_CDE",
					"PTSS_VEH_FAUL_CDE",
					"PTSS_WRUP_QLTY_CDE",
					"PTSS_WRUP_RSN_CDE",
					"PTSS_WRUP_TRGR_CDE",
					"QEC_PART_GSP_CLST",
					"QEC_PART_HIST",
					"RA_CLM",
					"RO_LINE_DMG_REV",
					"RO_PART_DISP",
					"SP_CASE",
					"T3_DCSN",
					"T3_PART",
					"VEH_CMP_GRP_CDE",
					"VEH_CMP_SUBGRP_CDE",
					"VEH_SYMPTOM",
					"VEH_WRNTY_PKG",
					"WRCL_DMG_DECCDE_AU",
					"WRCL_DMG_DECSN_CDE",
					"WRCL_DMG_DTL_AUD",
					"WRCL_DMG_TXT",
					"WRNTY_CLM_DMG_REV",
					"WRNTY_PKG_EXPNS",
					"WRNTY_PKG_PRCNG",
					"WRNTY_VEH",
					"WRNTY_VEH_AUD",
					"WRNTY_VEH_OPT",
					"WRNTY_VEH_STAT_SEC",
					"WRNTY_VEH_STAT_SEC_CDE",
					"WRN_PART_DISP_SMRY",
					"WSG_CASE",
					"WSG_CASE_CATG_CD",
					"WSG_CASE_HIST",
					"WSG_CNTC",
					"WSG_CNTC_STAT_CD",
					"WSG_DLR_ASSC",
					"WSG_PROB",
					"WSG_PROB_SLTN",
					"WSG_SLTN"
				]
			},
			"Dealer_table": {
				"type": "array",
				"defaultValue": [
					"MARKET",
					"MARKET_AREA",
					"REGION",
					"SPOM",
					"DLR_FRAN_TYP_CDE",
					"DLR_PGM_AGRMT_TYP_CDE",
					"SPCL_PGM_RETLR_AGR"
				]
			}
		},
		"folder": {
			"name": "VDW"
		},
		"annotations": []
	}
}